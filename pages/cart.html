<!DOCTYPE HTML>
<html lang="en">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="author" content="Bootstrap-ecommerce by Vosidiy">

        <title>Magazin online</title>

        <link rel="shortcut icon" type="image/x-icon" href="../images/icons/Shopping-bag-orange-icon.png">

        <script src="https://www.gstatic.com/firebasejs/8.2.3/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.2.3/firebase-firestore.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.2.3/firebase-auth.js"></script>

        <!-- jQuery -->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

        <!-- Bootstrap4 files-->
        <script src="../js/bootstrap.bundle.min.js" type="text/javascript"></script>
        <link href="../css/bootstrap.min.css" rel="stylesheet" type="text/css" />


        <!-- Font awesome 5 -->
        <link href="../fonts/fontawesome/css/fontawesome-all.min.css" type="text/css" rel="stylesheet">

        <!-- plugin: fancybox  -->
        <script src="../plugins/fancybox/fancybox.min.js" type="text/javascript"></script>
        <link href="../plugins/fancybox/fancybox.min.css" type="text/css" rel="stylesheet">

        <!-- custom style -->
        <link href="../css/ui.css" rel="stylesheet" type="text/css" />
        <link href="../css/styles.css" rel="stylesheet" type="text/css" />
        <link href="../css/responsive.css" rel="stylesheet" media="only screen and (max-width: 1200px)" />

        <!-- custom javascript -->
        <script src="../js/script.js" type="text/javascript"></script>

        <script type="text/javascript">
            /// some script
            // jquery ready start
            $(document).ready(function () {
                // jQuery code

            });
        // jquery end

        </script>

    </head>
    <body class="bg">
        <!-- ========================= SECTION HEADER ========================= -->
        <header class="font-size header-bg">
			<section class="header-bg d-flex flex-column">
				<div class="pt-4 d-flex flex-row justify-content-around flex-wrap">

					<div class="row justify-content-between">
						<!-- LOGO -->
						<div class="brand-wrap">
							<a href="../index.html">
								<img src="../images/logos/logo.png">
							</a>
						</div> 
					</div>
					<!-- ACCOUNT INFO -->
					<div class="d-flex flex-row align-items-center justify-content-between infoContainer">
						<!-- SIGN IN DROPDOWN -->
						<div>
							<a href="#" data-toggle="dropdown" data-offset="20,10">
								<button style="display: none;" class="login btn-edit btn-primary"> Sign in </button>
							</a>
				
							<button style="display: none;" class="logout btn-edit btn-primary"> Sign Out </button>
							
							<div class="dropdown-menu">
								<form class="login-form px-4 py-3">
									<div class="form-group">
										<label>Email address</label>
										<input id="signIn-email" type="email" class="form-control"
											placeholder="email@example.com">
									</div>
									<div class="form-group">
										<label>Password</label>
										<input id="signIn-password" type="password" class="form-control" placeholder="Password">
									</div>
									<button type="submit" class="sign-in-button">Sign in</button>
								</form>
								<hr class="dropdown-divider">
								<a class="dropdown-item" href="registration.html">Don't have an account? Sign
									up</a>
								<a class="dropdown-item" href="#">Forgot password?</a>
							</div> 
						</div> 
						<!-- BASKET -->
						<div>
							<a href="cart.html" class="widget-header">
								<div class="icontext">
									<div class="icon-wrap"><i class="fa fa-shopping-basket"></i></div>
									<div class="text-wrap">Basket</div>
								</div>
							</a>
						</div> 
						<!-- FAVORITES -->
						<div>
							<a href="favorites.html" class="widget-header">
								<div class="icontext">
									<div class="icon-wrap"><i class="fa fa-heart"></i></div>
									<div class="text-wrap">Favorites</div>
								</div>
							</a>
						</div>
					</div>
				</div>

				<nav class="ml-lg-5 section-width navbar navbar-expand-lg header-bg d-flex justify-content-around">

					<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
						<i class="fa fa-bars" aria-hidden="true"></i>
					</button>
				  
					<div class="collapse navbar-collapse" id="navbarSupportedContent">
						<ul class="navbar-nav">
							<li class="nav-item active"><a class="nav-link" href="../index.html">Home </a></li>
							<li class="nav-item"><a class="nav-link" href="ourStory.html"> Our Story </a></li>
							<li class="nav-item dropdown">
								<a class="nav-link  dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
								Backpacks </a>
								<ul class="dropdown-menu header-bg">
									<li><a class=" text-center dropdown-item"href="../categories/backpacks.html"><strong>See all</strong></a></li>
									<hr class="mt-0 mb-0 pt-1 text-center w-75">	
									<li><a class="dropdown-item" href="../categories/etnobackpacks.html"> Etno</a></li>
									<li><a class="dropdown-item" href="../categories/elegantbackpacks.html"> Elegant </a></li>
									<li><a class="dropdown-item" href="../categories/sportbackpacks.html"> Sport </a></li>
								</ul>
							</li>
							<li class="nav-item"><a class="nav-link" href="../categories/others.html"> Others </a></li>
							<li class="nav-item"><a class="nav-link" href="contacts.html"> Contacts </a></li>
						</ul>
					</div>

					<form action="#" class="form-inline">
						<input type="text" class="form-control mr-sm-2" placeholder="Search">
							<div class="input-group-append">
							<button class="btn btn-primary btn-edit" type="submit">
								<i class="fa fa-search"></i>
							</button>
							</div>
					</form>
				</nav>				 
			</section> 
		</header>
        <!-- ========================= SECTION HEADER ENDS ==================== -->

        <!-- ========================= SECTION CONTENT ======================== -->
        <div class="top-box">
            <div id="authChecker" class="container">
                <div class="row">
                    <div class="col-lg-8 col-md-12">
                        <div class="mb-3">
                            <div class="pt-4 wish-list">
                                <h5 class="mb-4">Cart (<span id="span"></span>)</h5>
                                <hr class="mb-4">
                                <div id="cartList"></div>
                            </div>
                            <p class="text-primary mb-0"><i class="fas fa-info-circle mr-1"></i> Do not delay the purchase, adding items to your cart does not mean booking them.</p>
                        </div>
                        <div class="mb-3">
                            <div class="pt-4">

                                <h5 class="mb-4">Expected shipping delivery</h5>

                                <p class="mb-0"> Thu., 12.03. - Mon., 16.03.</p>
                            </div>
                        </div>

                    </div>
                    <div class="col-lg-4 col-md-12">
                        <div class="mb-3 pt-4">
                            <h5 class="mb-3">The total amount of:</h5>

                            <div class="pt-2 d-flex flex-column">
                                
                                <div id="preaside" class="pt-2 d-flex flex-column"></div>

                                <div class="pt-2 d-flex flex-row justify-content-between">
                                    <span>Shipping:</span>
                                    <span>Free</span>
                                </div>

                                <div class="pt-2 pb-2 d-flex flex-row justify-content-between">
                                    <span><strong>To pay:</strong></span>
                                    <span class="font-weight-bold" id="total-price">$120.00</span>
                                </div>

                                <button type="button" class="btn-edit btn-primary btn-block">go to checkout</button>

                            </div>
                        </div>
                    </div>
                </div> 
            </div>
        </div>
        <!-- ========================= SECTION CONTENT ENDS =================== -->

        <!-- ========================= FOOTER ================================= -->
        <footer class="section-footer header-bg ">
            <div class="top-box">
                <div class="container">
                    <section class="footer-top pt-4">
                        <div class="row">
                            <div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 col-2xs-6 col-3xs-12">
                                <div class="bordright">
                                    <p class="green title">About Hemp &amp; Linen</p>

                                    <ul class="foot list-unstyled">
										<li><a href="ourStory.html">Our Story</a></li>
										<li><a href="termsAndConditions.html">Terms and conditions</a></li>
										<li><a href="delivery.html">Delivery and payment</a></li>
									</ul>


                                </div>
                            </div>

                            <div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 col-2xs-6 col-3xs-12">
                                <div class="bordright nobord650">
                                    <p class=" green title">Our Marketplace</p>

                                    <ul class="foot list-unstyled">
                                        <li><a href="../categories/etnobackpacks.html">Etno backpacks</a></li>
                                        <li><a href="../categories/elegantbackpacks.html">Elegant backpacks</a></li>
                                        <li><a href="../categories/sportbackpacks.html">Sport backpacks</a></li>
                                        <li><a href="../categories/others.html">Others</a></li>
                                    </ul>
                                </div>
                            </div>

                            <div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 col-2xs-6 col-3xs-12">
                                <div class="bordright">
                                    <p class="green title">Customer Service</p>

                                    <ul class="foot list-unstyled">
                                        <li><a href="../index.html">Home</a></li>
                                        <li><a href="contacts.html">Contact Us</a></li>
                                        <li><a href="registration.html">My Account</a></li>
                                        <li><a href="cart.html">My Cart</a></li>
                                    </ul>
                                </div>
                            </div>

                            <div class="col-lg-3 col-md-6 col-sm-6 col-xs-6 col-2xs-6 col-3xs-12">
								<div class="bordrightlast">
									<p class="green title">Contacts</p>
					
									<ul class="foot list-unstyled">
										<li>Stefan cel Mare 1, Timisoara </li>
										<li>+ 40 234 567 89 </li>
										<li>info@gmail.com </li>
									</ul>
								</div>
								<div class="mb-2 btn-group white">
									<a class="btn btn-facebook" title="Facebook" target="_blank" href="https://www.facebook.com/realizatecudragoste/"><i class="fab fa-facebook-f  fa-fw"></i></a>
									<a class="btn btn-instagram" title="Instagram" target="_blank" href="#"><i class="fab fa-instagram  fa-fw"></i></a>
									<a class="btn btn-youtube" title="Youtube" target="_blank" href="#"><i class="fab fa-youtube  fa-fw"></i></a>
									<a class="btn btn-twitter" title="Twitter" target="_blank" href="#"><i class="fab fa-twitter  fa-fw"></i></a>
								</div>
							</div>
                        </div>
                    </section>
                </div>
            </div>
        </footer>
        <!-- ========================= FOOTER END ============================= -->
    </body>
        <script src="../js/firebase.js"></script>
        <script src="../js/auth.js"> </script>
        
        <script src="../js/product.js" type="text/javascript"></script>
        <script src="../js/orders.js" type="text/javascript"></script>

        <script>     
            firebase.auth().onAuthStateChanged(user => {
                if (user) {
                    console.log(user)
                    var uid = user.uid;
                    getCartProducts(uid);
                    registerCartClickEvents();
                }
                else {
                    getCartProducts();
                }
            });  

            function getCartProducts (uid) {
                if (uid) {

                    var usersProducts = db.collection("users").doc(uid);
                usersProducts.get().then( function(doc) {
                    if (doc.exists) {
                        console.log("Document data:", doc.data());
                        var products = doc.data().orderProducts;
                        products.forEach(function(product) {
                            renderCartProduct(product.productId, product.quantity);  
                        });          
                    } else {
                        console.log("No such document!");
                    }
                }).catch(function(error) {
                    console.log("Error getting document:", error);
                });

                } else {
                    renderCartProduct();
                }
                
        
            };
    </script>
</html>